CREATE TABLE COMUNIDAD (
       ID_COMUNIDAD INT NOT NULL IDENTITY PRIMARY KEY
     , CALLE VARCHAR(12)
     , MAX_RECIBOS_PENDIENTES INT
     , ESTADO VARCHAR(12)
);

CREATE TABLE CONCEPTO (
       ID_CONCEPTO INT NOT NULL
     , CLAVE_CONCEPTO VARCHAR(12)
     , DESCRIPCION VARCHAR(12)
     , PRIMARY KEY (ID_CONCEPTO)
);

CREATE TABLE PROPIETARIO (
       NIF INT NOT NULL
     , NOMBRE VARCHAR(12)
     , DIRECCION VARCHAR(12)
     , POBLACION VARCHAR(12)
     , TELEFONO VARCHAR(12)
     , OBSERVACIONES VARCHAR(12)
     , FECHA_ALTA VARCHAR(12)
     , ENTIDAD VARCHAR(12)
     , NUMERO_CUENTA VARCHAR(12)
     , PRIMARY KEY (NIF)
);

CREATE TABLE INMUEBLE (
       ID INT NOT NULL IDENTITY PRIMARY KEY
     , ESCALERA VARCHAR(12)
     , PISO VARCHAR(12)
     , PUERTA CHAR(10)
     , PORCENTAJE FLOAT
     , NIF INT NOT NULL
     , ID_COMUNIDAD INT NOT NULL
);

CREATE TABLE NOTA_INFORMATIVA (
       ID_NOTA INT NOT NULL IDENTITY PRIMARY KEY
     , FECHA_CALCULO VARCHAR(12)
     , IMPORTE_NOTA FLOAT
     , ID_COMUNIDAD INT NOT NULL
);

CREATE TABLE FACTURA (
       NUM_FACTURA INT NOT NULL
     , FECHA_FACTURA VARCHAR(12)
     , ID_COMUNIDAD INT NOT NULL
     , ID_NOTA INT 
     , PRIMARY KEY (NUM_FACTURA)
);

CREATE TABLE RECIBO_INMUEBLE (
       ID_RECIBO INT NOT NULL
     , FECHA_PAGO VARCHAR(12)
     , IMPORTE FLOAT
     , ID_NOTA INT 
     , ID INT 
     , PRIMARY KEY (ID_RECIBO)
);

CREATE TABLE LINEA_FACTURA (
       ID_LINEA INT NOT NULL IDENTITY PRIMARY KEY
     , IMPORTE_LINEA FLOAT
     , OBSERVACION VARCHAR(12)
     , ID_CONCEPTO INT NOT NULL
     , NUM_FACTURA INT NOT NULL
);

ALTER TABLE INMUEBLE
  ADD CONSTRAINT FK_INMUEBLE_1
      FOREIGN KEY (NIF)
      REFERENCES PROPIETARIO (NIF);

ALTER TABLE INMUEBLE
  ADD CONSTRAINT FK_INMUEBLE_2
      FOREIGN KEY (ID_COMUNIDAD)
      REFERENCES COMUNIDAD (ID_COMUNIDAD);

ALTER TABLE NOTA_INFORMATIVA
  ADD CONSTRAINT FK_NOTA_INFORMATIVA_1
      FOREIGN KEY (ID_COMUNIDAD)
      REFERENCES COMUNIDAD (ID_COMUNIDAD);

ALTER TABLE FACTURA
  ADD CONSTRAINT FK_FACTURA_1
      FOREIGN KEY (ID_COMUNIDAD)
      REFERENCES COMUNIDAD (ID_COMUNIDAD);

ALTER TABLE FACTURA
  ADD CONSTRAINT FK_FACTURA_2
      FOREIGN KEY (ID_NOTA)
      REFERENCES NOTA_INFORMATIVA (ID_NOTA);

ALTER TABLE RECIBO_INMUEBLE
  ADD CONSTRAINT FK_RECIBO_INMUEBLE_1
      FOREIGN KEY (ID_NOTA)
      REFERENCES NOTA_INFORMATIVA (ID_NOTA);

ALTER TABLE RECIBO_INMUEBLE
  ADD CONSTRAINT FK_RECIBO_INMUEBLE_2
      FOREIGN KEY (ID)
      REFERENCES INMUEBLE (ID);

ALTER TABLE LINEA_FACTURA
  ADD CONSTRAINT FK_LINEA_FACTURA_1
      FOREIGN KEY (ID_CONCEPTO)
      REFERENCES CONCEPTO (ID_CONCEPTO);

ALTER TABLE LINEA_FACTURA
  ADD CONSTRAINT FK_LINEA_FACTURA_2
      FOREIGN KEY (NUM_FACTURA)
      REFERENCES FACTURA (NUM_FACTURA);